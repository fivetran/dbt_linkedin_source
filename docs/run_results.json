{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.17", "generated_at": "2024-07-18T20:05:06.774624Z", "invocation_id": "2a69ab7c-befa-4b06-89b7-0cc5e741d25e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.823282Z", "completed_at": "2024-07-18T20:05:03.856888Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.859704Z", "completed_at": "2024-07-18T20:05:03.859713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.043727874755859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_account_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.853584Z", "completed_at": "2024-07-18T20:05:03.857206Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.859987Z", "completed_at": "2024-07-18T20:05:03.859994Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04291391372680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_campaign_group_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.851133Z", "completed_at": "2024-07-18T20:05:03.857594Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.863371Z", "completed_at": "2024-07-18T20:05:03.863376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.043834686279296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_creative_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_ad_analytics_by_creative_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.847923Z", "completed_at": "2024-07-18T20:05:03.857885Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.863716Z", "completed_at": "2024-07-18T20:05:03.863720Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04472494125366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_campaign_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_ad_analytics_by_campaign_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.875543Z", "completed_at": "2024-07-18T20:05:03.877185Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.879633Z", "completed_at": "2024-07-18T20:05:03.879640Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012557029724121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.877476Z", "completed_at": "2024-07-18T20:05:03.878326Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.880341Z", "completed_at": "2024-07-18T20:05:03.880344Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013171911239624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_ad_analytics_by_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.869909Z", "completed_at": "2024-07-18T20:05:03.879092Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.881321Z", "completed_at": "2024-07-18T20:05:03.881325Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015270233154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_campaign_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.872990Z", "completed_at": "2024-07-18T20:05:03.879873Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.882346Z", "completed_at": "2024-07-18T20:05:03.882348Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015943288803100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__creative_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_creative_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.885780Z", "completed_at": "2024-07-18T20:05:03.886953Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.891379Z", "completed_at": "2024-07-18T20:05:03.891384Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01017308235168457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_ad_analytics_by_creative_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.888051Z", "completed_at": "2024-07-18T20:05:03.889166Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.892980Z", "completed_at": "2024-07-18T20:05:03.892983Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010009765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_campaign_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.889942Z", "completed_at": "2024-07-18T20:05:03.890891Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.894025Z", "completed_at": "2024-07-18T20:05:03.894029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01016688346862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.891617Z", "completed_at": "2024-07-18T20:05:03.892512Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:03.894968Z", "completed_at": "2024-07-18T20:05:03.894971Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009208917617797852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_creative_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.906528Z", "completed_at": "2024-07-18T20:05:05.061035Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.061538Z", "completed_at": "2024-07-18T20:05:05.061545Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.260810136795044, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    cast(null as boolean) as \n    \n    backfilled\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as timestamp) as \n    \n    run_schedule_end\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_start\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as campaign_group_id,\n        name as campaign_group_name,\n        account_id,\n        status,\n        backfilled as is_backfilled,\n        cast(run_schedule_start as timestamp) as run_schedule_start_at,\n        cast(run_schedule_end as timestamp) as run_schedule_end_at,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.898432Z", "completed_at": "2024-07-18T20:05:05.105296Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.106587Z", "completed_at": "2024-07-18T20:05:05.106593Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.320559024810791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as TEXT) as \n    \n    status\n    \n , \n    cast(null as TEXT) as \n    \n    type\n    \n , \n    \n    \n    version_tag\n    \n as \n    \n    version_tag\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as account_id,\n        name as account_name,\n        currency,\n        cast(version_tag as numeric) as version_tag,\n        status,\n        type,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.917019Z", "completed_at": "2024-07-18T20:05:05.106116Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.107492Z", "completed_at": "2024-07-18T20:05:05.107495Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3177769184112549, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign_tmp\"\n),\n\nmacro as (\n\n    select\n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_in_local_currency\n    \n as \n    \n    cost_in_local_currency\n    \n, \n    \n    \n    cost_in_usd\n    \n as \n    \n    cost_in_usd\n    \n, \n    \n    \n    day\n    \n as \n    \n    day\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversion_value_in_local_currency\n    \n as \n    \n    conversion_value_in_local_currency\n    \n, \n    \n    \n    external_website_conversions\n    \n as \n    \n    external_website_conversions\n    \n, \n    \n    \n    one_click_leads\n    \n as \n    \n    one_click_leads\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfields as (\n    \n    select \n        source_relation,\n        date_trunc('day', day) as date_day,\n        campaign_id,\n        clicks,\n        impressions,\n        \n        cost_in_usd as cost,\n        \n\n        cast(coalesce(conversion_value_in_local_currency, 0) as float) as conversion_value_in_local_currency\n\n        \n            , coalesce(external_website_conversions, 0) as external_website_conversions\n        \n            , coalesce(one_click_leads, 0) as one_click_leads\n        \n\n        \n\n\n\n\n\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:03.911268Z", "completed_at": "2024-07-18T20:05:05.105613Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.107027Z", "completed_at": "2024-07-18T20:05:05.107030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3271360397338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_creative", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_in_local_currency\n    \n as \n    \n    cost_in_local_currency\n    \n, \n    \n    \n    cost_in_usd\n    \n as \n    \n    cost_in_usd\n    \n, \n    \n    \n    creative_id\n    \n as \n    \n    creative_id\n    \n, \n    \n    \n    day\n    \n as \n    \n    day\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversion_value_in_local_currency\n    \n as \n    \n    conversion_value_in_local_currency\n    \n, \n    \n    \n    external_website_conversions\n    \n as \n    \n    external_website_conversions\n    \n, \n    \n    \n    one_click_leads\n    \n as \n    \n    one_click_leads\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select\n        source_relation,\n        date_trunc('day', day) as date_day,\n        creative_id,\n        clicks, \n        impressions,\n        \n        cost_in_usd as cost,\n        \n\n        cast(coalesce(conversion_value_in_local_currency, 0) as float) as conversion_value_in_local_currency\n\n        \n            , coalesce(external_website_conversions, 0) as external_website_conversions\n        \n            , coalesce(one_click_leads, 0) as one_click_leads\n        \n\n        \n\n\n\n\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.226648Z", "completed_at": "2024-07-18T20:05:05.240472Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.241437Z", "completed_at": "2024-07-18T20:05:05.241442Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016767024993896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__campaign_group_history_source_relation__last_modified_at__campaign_group_id.4c9f328639", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, last_modified_at, campaign_group_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\n    group by source_relation, last_modified_at, campaign_group_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.235319Z", "completed_at": "2024-07-18T20:05:05.240767Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.241673Z", "completed_at": "2024-07-18T20:05:05.241678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016319990158081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_group_history_campaign_group_id.3888f3777d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_group_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\nwhere campaign_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.244463Z", "completed_at": "2024-07-18T20:05:05.250618Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.251348Z", "completed_at": "2024-07-18T20:05:05.251354Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008607149124145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_group_history_last_modified_at.a716e2a7ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_modified_at\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\nwhere last_modified_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.247321Z", "completed_at": "2024-07-18T20:05:05.251088Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.252509Z", "completed_at": "2024-07-18T20:05:05.252515Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009667158126831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__account_history_source_relation__account_id__version_tag.c7a0383d8c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, version_tag\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\n    group by source_relation, account_id, version_tag\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.254985Z", "completed_at": "2024-07-18T20:05:05.261995Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.263107Z", "completed_at": "2024-07-18T20:05:05.263112Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010086774826049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__account_history_account_id.a9fa7f93c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.258397Z", "completed_at": "2024-07-18T20:05:05.262323Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.263350Z", "completed_at": "2024-07-18T20:05:05.263354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009802818298339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__account_history_version_tag.58c46c5d81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect version_tag\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\nwhere version_tag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.270262Z", "completed_at": "2024-07-18T20:05:05.273276Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.274243Z", "completed_at": "2024-07-18T20:05:05.274249Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009190082550048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_campaign_campaign_id.d6ae242f1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.266518Z", "completed_at": "2024-07-18T20:05:05.273547Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.274496Z", "completed_at": "2024-07-18T20:05:05.274498Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010027170181274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__ad_analytics_by_campaign_source_relation__date_day__campaign_id.41aa0d6322", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\n    group by source_relation, date_day, campaign_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.280124Z", "completed_at": "2024-07-18T20:05:05.283253Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.284223Z", "completed_at": "2024-07-18T20:05:05.284228Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008316993713378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__ad_analytics_by_creative_source_relation__date_day__creative_id.7b7d839d38", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, creative_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\n    group by source_relation, date_day, creative_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.277331Z", "completed_at": "2024-07-18T20:05:05.283523Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.284469Z", "completed_at": "2024-07-18T20:05:05.284472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009196996688842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_campaign_date_day.ef97bed766", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.290714Z", "completed_at": "2024-07-18T20:05:05.293454Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.294404Z", "completed_at": "2024-07-18T20:05:05.294410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00863504409790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_creative_date_day.cb81bc4766", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.287328Z", "completed_at": "2024-07-18T20:05:05.294094Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:05.295542Z", "completed_at": "2024-07-18T20:05:05.295546Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00980997085571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_creative_creative_id.062abfe14b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\nwhere creative_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.159538Z", "completed_at": "2024-07-18T20:05:06.504904Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.505376Z", "completed_at": "2024-07-18T20:05:06.505382Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4543871879577637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    cast(null as boolean) as \n    \n    audience_expansion_enabled\n    \n , \n    \n    \n    campaign_group_id\n    \n as \n    \n    campaign_group_id\n    \n, \n    cast(null as TEXT) as \n    \n    cost_type\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    cast(null as TEXT) as \n    \n    creative_selection\n    \n , \n    cast(null as float) as \n    \n    daily_budget_amount\n    \n , \n    cast(null as TEXT) as \n    \n    daily_budget_currency_code\n    \n , \n    cast(null as TEXT) as \n    \n    format\n    \n , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    cast(null as TEXT) as \n    \n    locale_country\n    \n , \n    cast(null as TEXT) as \n    \n    locale_language\n    \n , \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as TEXT) as \n    \n    objective_type\n    \n , \n    cast(null as boolean) as \n    \n    offsite_delivery_enabled\n    \n , \n    cast(null as TEXT) as \n    \n    optimization_target_type\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_end\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_start\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n , \n    cast(null as TEXT) as \n    \n    type\n    \n , \n    cast(null as float) as \n    \n    unit_cost_amount\n    \n , \n    cast(null as TEXT) as \n    \n    unit_cost_currency_code\n    \n , \n    \n    \n    version_tag\n    \n as \n    \n    version_tag\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as campaign_id,\n        name as campaign_name,\n        cast(version_tag as numeric) as version_tag,\n        campaign_group_id,\n        account_id,\n        status,\n        type,\n        cost_type,\n        creative_selection,\n        daily_budget_amount,\n        daily_budget_currency_code,\n        unit_cost_amount,\n        unit_cost_currency_code,\n        format,\n        locale_country,\n        locale_language,\n        objective_type,\n        optimization_target_type,\n        audience_expansion_enabled as is_audience_expansion_enabled,\n        offsite_delivery_enabled as is_offsite_delivery_enabled,\n        cast(run_schedule_start as timestamp) as run_schedule_start_at,\n        cast(run_schedule_end as timestamp) as run_schedule_end_at,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:06.616276Z", "completed_at": "2024-07-18T20:05:06.625091Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.657878Z", "completed_at": "2024-07-18T20:05:06.657889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04328513145446777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__campaign_history_source_relation__version_tag__campaign_id.65ed9cedae", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, version_tag, campaign_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\n    group by source_relation, version_tag, campaign_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:06.621143Z", "completed_at": "2024-07-18T20:05:06.656109Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.659248Z", "completed_at": "2024-07-18T20:05:06.659251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04020977020263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_history_campaign_id.b026971ca2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:06.625538Z", "completed_at": "2024-07-18T20:05:06.658434Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.660475Z", "completed_at": "2024-07-18T20:05:06.660479Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04082918167114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_history_version_tag.64954cc469", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect version_tag\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\nwhere version_tag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:05.217706Z", "completed_at": "2024-07-18T20:05:06.659695Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.661452Z", "completed_at": "2024-07-18T20:05:06.661455Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5502259731292725, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__creative_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    click_uri\n    \n as \n    \n    click_uri\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    cast(null as timestamp) as \n    \n    created_at\n    \n , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as timestamp) as \n    \n    last_modified_time\n    \n , \n    \n    \n    last_modified_at\n    \n as \n    \n    last_modified_at\n    \n, \n    \n    \n    intended_status\n    \n as \n    \n    intended_status\n    \n, \n    cast(null as TEXT) as \n    \n    status\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select\n        source_relation,\n        id as creative_id,\n        campaign_id,\n        coalesce(status, intended_status) as status,\n        click_uri,\n        cast(coalesce(last_modified_time, last_modified_at) as timestamp) as last_modified_at,\n        cast(coalesce(created_time, created_at) as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by coalesce(last_modified_time, last_modified_at) desc) = 1 as is_latest_version\n\n    from macro\n\n), url_fields as (\n\n    select \n        *,\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term\n    \n    from fields\n)\n\nselect *\nfrom url_fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T20:05:06.768888Z", "completed_at": "2024-07-18T20:05:06.772097Z"}, {"name": "execute", "started_at": "2024-07-18T20:05:06.772562Z", "completed_at": "2024-07-18T20:05:06.772567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004687070846557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__creative_history_creative_id.4d51d55474", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history\"\nwhere creative_id is null\n\n\n", "relation_name": null}], "elapsed_time": 6.59439492225647, "args": {"partial_parse_file_diff": true, "populate_cache": true, "quiet": false, "macro_debugging": false, "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "exclude": [], "which": "generate", "invocation_command": "dbt docs generate -t postgres", "use_colors_file": true, "log_file_max_bytes": 10485760, "profiles_dir": "/Users/avinash.kunnath/.dbt", "show_resource_report": false, "empty_catalog": false, "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": false, "static": false, "favor_state": false, "vars": {}, "use_colors": true, "strict_mode": false, "compile": true, "log_format": "default", "log_level": "info", "target": "postgres", "write_json": true, "defer": false, "introspect": true, "version_check": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/linkedin/dbt_linkedin_source/integration_tests", "print": true, "enable_legacy_logger": false, "log_format_file": "debug", "select": [], "static_parser": true, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/linkedin/dbt_linkedin_source/integration_tests/logs", "partial_parse": true, "cache_selected_only": false}}