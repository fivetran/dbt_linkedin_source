{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.16", "generated_at": "2024-06-24T17:13:23.872187Z", "invocation_id": "06e82489-783c-435a-b66a-d7ec67fd5631", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.069000Z", "completed_at": "2024-06-24T17:13:23.099444Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.100937Z", "completed_at": "2024-06-24T17:13:23.100957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03622293472290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_account_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.088943Z", "completed_at": "2024-06-24T17:13:23.099785Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.101819Z", "completed_at": "2024-06-24T17:13:23.101823Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03666090965270996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_campaign_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_ad_analytics_by_campaign_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.092427Z", "completed_at": "2024-06-24T17:13:23.100404Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.102871Z", "completed_at": "2024-06-24T17:13:23.102874Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03734087944030762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_creative_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_ad_analytics_by_creative_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.095515Z", "completed_at": "2024-06-24T17:13:23.101269Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.104122Z", "completed_at": "2024-06-24T17:13:23.104126Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03800606727600098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_campaign_group_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.116428Z", "completed_at": "2024-06-24T17:13:23.117642Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.120683Z", "completed_at": "2024-06-24T17:13:23.120694Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01461029052734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.108346Z", "completed_at": "2024-06-24T17:13:23.118084Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.121225Z", "completed_at": "2024-06-24T17:13:23.121229Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017732858657836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_campaign_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.118359Z", "completed_at": "2024-06-24T17:13:23.119252Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.121498Z", "completed_at": "2024-06-24T17:13:23.121501Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01163792610168457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_ad_analytics_by_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.112547Z", "completed_at": "2024-06-24T17:13:23.119804Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.122398Z", "completed_at": "2024-06-24T17:13:23.122402Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018124103546142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__creative_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"linkedin_source_integration_tests_3\".\"linkedin_creative_history_data\"", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.128119Z", "completed_at": "2024-06-24T17:13:23.130066Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.135738Z", "completed_at": "2024-06-24T17:13:23.135749Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011989116668701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_ad_analytics_by_creative_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.130669Z", "completed_at": "2024-06-24T17:13:23.131826Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.136427Z", "completed_at": "2024-06-24T17:13:23.136432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011903047561645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_campaign_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.132189Z", "completed_at": "2024-06-24T17:13:23.133251Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.136772Z", "completed_at": "2024-06-24T17:13:23.136778Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011879920959472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.133994Z", "completed_at": "2024-06-24T17:13:23.134973Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.137721Z", "completed_at": "2024-06-24T17:13:23.137724Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01195383071899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.linkedin_source_integration_tests.linkedin_creative_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.142870Z", "completed_at": "2024-06-24T17:13:23.486757Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.494333Z", "completed_at": "2024-06-24T17:13:23.494343Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.37952423095703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as TEXT) as \n    \n    status\n    \n , \n    cast(null as TEXT) as \n    \n    type\n    \n , \n    \n    \n    version_tag\n    \n as \n    \n    version_tag\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as account_id,\n        name as account_name,\n        currency,\n        cast(version_tag as numeric) as version_tag,\n        status,\n        type,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.163978Z", "completed_at": "2024-06-24T17:13:23.493989Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.495999Z", "completed_at": "2024-06-24T17:13:23.496003Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.38669705390930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    cast(null as boolean) as \n    \n    backfilled\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as timestamp) as \n    \n    run_schedule_end\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_start\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as campaign_group_id,\n        name as campaign_group_name,\n        account_id,\n        status,\n        backfilled as is_backfilled,\n        cast(run_schedule_start as timestamp) as run_schedule_start_at,\n        cast(run_schedule_end as timestamp) as run_schedule_end_at,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.150124Z", "completed_at": "2024-06-24T17:13:23.494633Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.496704Z", "completed_at": "2024-06-24T17:13:23.496713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.38825488090515137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign_tmp\"\n),\n\nmacro as (\n\n    select\n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_in_local_currency\n    \n as \n    \n    cost_in_local_currency\n    \n, \n    \n    \n    cost_in_usd\n    \n as \n    \n    cost_in_usd\n    \n, \n    \n    \n    day\n    \n as \n    \n    day\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversion_value_in_local_currency\n    \n as \n    \n    conversion_value_in_local_currency\n    \n, \n    \n    \n    external_website_conversions\n    \n as \n    \n    external_website_conversions\n    \n, \n    \n    \n    one_click_leads\n    \n as \n    \n    one_click_leads\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfields as (\n    \n    select \n        source_relation,\n        date_trunc('day', day) as date_day,\n        campaign_id,\n        clicks,\n        impressions,\n        \n        cost_in_usd as cost,\n        \n\n        cast(coalesce(conversion_value_in_local_currency, 0) as float) as conversion_value_in_local_currency\n\n        \n            , coalesce(external_website_conversions, 0) as external_website_conversions\n        \n            , coalesce(one_click_leads, 0) as one_click_leads\n        \n\n        \n            \n                \n            \n                \n            \n        \n\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.155902Z", "completed_at": "2024-06-24T17:13:23.495296Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.497257Z", "completed_at": "2024-06-24T17:13:23.497260Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3883981704711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__ad_analytics_by_creative", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_in_local_currency\n    \n as \n    \n    cost_in_local_currency\n    \n, \n    \n    \n    cost_in_usd\n    \n as \n    \n    cost_in_usd\n    \n, \n    \n    \n    creative_id\n    \n as \n    \n    creative_id\n    \n, \n    \n    \n    day\n    \n as \n    \n    day\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    conversion_value_in_local_currency\n    \n as \n    \n    conversion_value_in_local_currency\n    \n, \n    \n    \n    external_website_conversions\n    \n as \n    \n    external_website_conversions\n    \n, \n    \n    \n    one_click_leads\n    \n as \n    \n    one_click_leads\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select\n        source_relation,\n        date_trunc('day', day) as date_day,\n        creative_id,\n        clicks, \n        impressions,\n        \n        cost_in_usd as cost,\n        \n\n        cast(coalesce(conversion_value_in_local_currency, 0) as float) as conversion_value_in_local_currency\n\n        \n            , coalesce(external_website_conversions, 0) as external_website_conversions\n        \n            , coalesce(one_click_leads, 0) as one_click_leads\n        \n\n        \n            \n                \n            \n                \n            \n        \n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.548696Z", "completed_at": "2024-06-24T17:13:23.556037Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.557382Z", "completed_at": "2024-06-24T17:13:23.557396Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025568008422851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__account_history_account_id.a9fa7f93c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.539854Z", "completed_at": "2024-06-24T17:13:23.556411Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.557701Z", "completed_at": "2024-06-24T17:13:23.557708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02668905258178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__account_history_source_relation__account_id__version_tag.c7a0383d8c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, version_tag\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\n    group by source_relation, account_id, version_tag\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.561721Z", "completed_at": "2024-06-24T17:13:23.568445Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.569661Z", "completed_at": "2024-06-24T17:13:23.569669Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01040196418762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__account_history_version_tag.58c46c5d81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect version_tag\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__account_history\"\nwhere version_tag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.564820Z", "completed_at": "2024-06-24T17:13:23.568843Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.569990Z", "completed_at": "2024-06-24T17:13:23.569995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010443925857543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__campaign_group_history_source_relation__last_modified_at__campaign_group_id.4c9f328639", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, last_modified_at, campaign_group_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\n    group by source_relation, last_modified_at, campaign_group_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.576886Z", "completed_at": "2024-06-24T17:13:23.579803Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.580845Z", "completed_at": "2024-06-24T17:13:23.580852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009232044219970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_group_history_last_modified_at.a716e2a7ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_modified_at\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\nwhere last_modified_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.573411Z", "completed_at": "2024-06-24T17:13:23.580127Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.581104Z", "completed_at": "2024-06-24T17:13:23.581115Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010256052017211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_group_history_campaign_group_id.3888f3777d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_group_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_group_history\"\nwhere campaign_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.584826Z", "completed_at": "2024-06-24T17:13:23.591662Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.592705Z", "completed_at": "2024-06-24T17:13:23.592713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01026296615600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__ad_analytics_by_campaign_source_relation__date_day__campaign_id.41aa0d6322", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\n    group by source_relation, date_day, campaign_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.588042Z", "completed_at": "2024-06-24T17:13:23.592221Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.594150Z", "completed_at": "2024-06-24T17:13:23.594159Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011500120162963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_campaign_campaign_id.d6ae242f1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.597622Z", "completed_at": "2024-06-24T17:13:23.605214Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.606138Z", "completed_at": "2024-06-24T17:13:23.606148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012859821319580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_campaign_date_day.ef97bed766", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_campaign\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.601293Z", "completed_at": "2024-06-24T17:13:23.608100Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.609955Z", "completed_at": "2024-06-24T17:13:23.609960Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013885974884033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__ad_analytics_by_creative_source_relation__date_day__creative_id.7b7d839d38", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, creative_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\n    group by source_relation, date_day, creative_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.611970Z", "completed_at": "2024-06-24T17:13:23.621551Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.622624Z", "completed_at": "2024-06-24T17:13:23.622669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014934778213500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_creative_creative_id.062abfe14b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\nwhere creative_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.617884Z", "completed_at": "2024-06-24T17:13:23.622165Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.625616Z", "completed_at": "2024-06-24T17:13:23.625626Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00939321517944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__ad_analytics_by_creative_date_day.cb81bc4766", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__ad_analytics_by_creative\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.521616Z", "completed_at": "2024-06-24T17:13:23.818680Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.819703Z", "completed_at": "2024-06-24T17:13:23.819714Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.32420778274536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    cast(null as boolean) as \n    \n    audience_expansion_enabled\n    \n , \n    \n    \n    campaign_group_id\n    \n as \n    \n    campaign_group_id\n    \n, \n    cast(null as TEXT) as \n    \n    cost_type\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    cast(null as TEXT) as \n    \n    creative_selection\n    \n , \n    cast(null as float) as \n    \n    daily_budget_amount\n    \n , \n    cast(null as TEXT) as \n    \n    daily_budget_currency_code\n    \n , \n    cast(null as TEXT) as \n    \n    format\n    \n , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    cast(null as TEXT) as \n    \n    locale_country\n    \n , \n    cast(null as TEXT) as \n    \n    locale_language\n    \n , \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    cast(null as TEXT) as \n    \n    objective_type\n    \n , \n    cast(null as boolean) as \n    \n    offsite_delivery_enabled\n    \n , \n    cast(null as TEXT) as \n    \n    optimization_target_type\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_end\n    \n , \n    cast(null as timestamp) as \n    \n    run_schedule_start\n    \n , \n    cast(null as TEXT) as \n    \n    status\n    \n , \n    cast(null as TEXT) as \n    \n    type\n    \n , \n    cast(null as float) as \n    \n    unit_cost_amount\n    \n , \n    cast(null as TEXT) as \n    \n    unit_cost_currency_code\n    \n , \n    \n    \n    version_tag\n    \n as \n    \n    version_tag\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select \n        source_relation,\n        id as campaign_id,\n        name as campaign_name,\n        cast(version_tag as numeric) as version_tag,\n        campaign_group_id,\n        account_id,\n        status,\n        type,\n        cost_type,\n        creative_selection,\n        daily_budget_amount,\n        daily_budget_currency_code,\n        unit_cost_amount,\n        unit_cost_currency_code,\n        format,\n        locale_country,\n        locale_language,\n        objective_type,\n        optimization_target_type,\n        audience_expansion_enabled as is_audience_expansion_enabled,\n        offsite_delivery_enabled as is_offsite_delivery_enabled,\n        cast(run_schedule_start as timestamp) as run_schedule_start_at,\n        cast(run_schedule_end as timestamp) as run_schedule_end_at,\n        cast(last_modified_time as timestamp) as last_modified_at,\n        cast(created_time as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_latest_version\n\n    from macro\n\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.533943Z", "completed_at": "2024-06-24T17:13:23.819427Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.820724Z", "completed_at": "2024-06-24T17:13:23.820730Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3138439655303955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.linkedin_source.stg_linkedin_ads__creative_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    click_uri\n    \n as \n    \n    click_uri\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    cast(null as timestamp) as \n    \n    created_at\n    \n , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as timestamp) as \n    \n    last_modified_time\n    \n , \n    \n    \n    last_modified_at\n    \n as \n    \n    last_modified_at\n    \n, \n    \n    \n    intended_status\n    \n as \n    \n    intended_status\n    \n, \n    cast(null as TEXT) as \n    \n    status\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n\n), fields as (\n\n    select\n        source_relation,\n        id as creative_id,\n        campaign_id,\n        coalesce(status, intended_status) as status,\n        click_uri,\n        cast(coalesce(last_modified_time, last_modified_at) as timestamp) as last_modified_at,\n        cast(coalesce(created_time, created_at) as timestamp) as created_at,\n        row_number() over (partition by source_relation, id order by coalesce(last_modified_time, last_modified_at) desc) = 1 as is_latest_version\n\n    from macro\n\n), url_fields as (\n\n    select \n        *,\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        click_uri,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        click_uri,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term\n    \n    from fields\n)\n\nselect *\nfrom url_fields", "relation_name": "\"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.849689Z", "completed_at": "2024-06-24T17:13:23.864968Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.866939Z", "completed_at": "2024-06-24T17:13:23.866948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021174192428588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.dbt_utils_unique_combination_of_columns_stg_linkedin_ads__campaign_history_source_relation__version_tag__campaign_id.65ed9cedae", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, version_tag, campaign_id\n    from \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\n    group by source_relation, version_tag, campaign_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.853122Z", "completed_at": "2024-06-24T17:13:23.865454Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.867517Z", "completed_at": "2024-06-24T17:13:23.867520Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02142786979675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_history_campaign_id.b026971ca2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.856641Z", "completed_at": "2024-06-24T17:13:23.866169Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.868589Z", "completed_at": "2024-06-24T17:13:23.868593Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021626710891723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__campaign_history_version_tag.64954cc469", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect version_tag\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__campaign_history\"\nwhere version_tag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-24T17:13:23.861660Z", "completed_at": "2024-06-24T17:13:23.866639Z"}, {"name": "execute", "started_at": "2024-06-24T17:13:23.869402Z", "completed_at": "2024-06-24T17:13:23.869406Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02136087417602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.linkedin_source.not_null_stg_linkedin_ads__creative_history_creative_id.4d51d55474", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect creative_id\nfrom \"postgres\".\"linkedin_source_integration_tests_3_linkedin_ads_source\".\"stg_linkedin_ads__creative_history\"\nwhere creative_id is null\n\n\n", "relation_name": null}], "elapsed_time": 1.9154891967773438, "args": {"version_check": true, "populate_cache": true, "log_format_file": "debug", "target": "postgres", "exclude": [], "defer": false, "macro_debugging": false, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": false, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/linkedin/dbt_linkedin_source/integration_tests", "profiles_dir": "/Users/avinash.kunnath/.dbt", "use_colors_file": true, "printer_width": 80, "log_file_max_bytes": 10485760, "select": [], "static_parser": true, "enable_legacy_logger": false, "log_format": "default", "compile": true, "show_resource_report": false, "introspect": true, "favor_state": false, "write_json": true, "indirect_selection": "eager", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "static": false, "invocation_command": "dbt docs generate -t postgres", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/linkedin/dbt_linkedin_source/integration_tests/logs", "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "empty_catalog": false, "vars": {}, "print": true, "cache_selected_only": false, "log_level": "info", "strict_mode": false, "which": "generate", "quiet": false, "partial_parse": true}}